{% extends "base.html" %}

{% block title %}Gallery - PixelParlour{% endblock %}

{% block content %}
<div class="gallery-header">
    <h1>Photo Gallery</h1>
    {% if photos %}
    <p>{{ photos.total }} beautiful moments</p>
    {% endif %}
</div>

<div class="gallery-grid">
    {% if photos and photos.items %}
        {% for photo in photos.items %}
        <div class="gallery-item">
            <a href="{{ url_for('view_photo', id=photo.id) }}">
                {% if photo.thumbnail_filename %}
                <img src="{{ url_for('thumbnail_file', filename=photo.thumbnail_filename) }}"
                     alt="{{ photo.title }}"
                     loading="lazy">
                {% else %}
                <img src="{{ url_for('uploaded_file', filename=photo.filename) }}"
                     alt="{{ photo.title }}"
                     loading="lazy">
                {% endif %}
                <div class="caption">
                    <h3>{{ photo.title }}</h3>
                    <p>{{ photo.caption[:50] }}{% if photo.caption and photo.caption|length > 50 %}...{% endif %}</p>
                    <div class="meta-info">
                        <span class="views">üëÅÔ∏è {{ photo.views }}</span>
                        <span class="date">{{ photo.upload_date.strftime('%b %d, %Y') }}</span>
                    </div>
                </div>
            </a>
            <form action="{{ url_for('delete_photo', id=photo.id) }}" method="POST" class="delete-form"
                  onsubmit="return confirm('Are you sure you want to delete this photo?');">
                <button type="submit" class="btn-delete">üóëÔ∏è Delete</button>
            </form>
        </div>
        {% endfor %}
    {% else %}
    <div class="empty-gallery">
        <p>üì∑ No photos in the gallery yet.</p>
        <a href="{{ url_for('upload') }}" class="btn">Upload First Photo</a>
    </div>
    {% endif %}
</div>

{% if photos and photos.pages and photos.pages > 1 %}
<div class="pagination">
    {% if photos.has_prev %}
        <a href="{{ url_for('gallery', page=photos.prev_num) }}" class="page-link">‚Üê Previous</a>
    {% endif %}

    <span class="current-page">Page {{ photos.page }} of {{ photos.pages }}</span>

    {% if photos.has_next %}
        <a href="{{ url_for('gallery', page=photos.next_num) }}" class="page-link">Next ‚Üí</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}