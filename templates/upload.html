{% extends "base.html" %}

{% block title %}Upload Photo - PixelParlour{% endblock %}

{% block content %}
<div class="upload-container">
    <h1>Upload New Photo</h1>

    <form method="POST" enctype="multipart/form-data" class="upload-form">
        {{ form.hidden_tag() }}

        <div class="form-group">
            {{ form.title.label }}
            {{ form.title(class="form-control", placeholder="Enter photo title") }}
            {% if form.title.errors %}
                {% for error in form.title.errors %}
                    <span class="error">{{ error }}</span>
                {% endfor %}
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.caption.label }}
            {{ form.caption(class="form-control", placeholder="Write a caption...", rows=3) }}
            {% if form.caption.errors %}
                {% for error in form.caption.errors %}
                    <span class="error">{{ error }}</span>
                {% endfor %}
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.photo.label }}
            <div class="file-input-wrapper">
                {{ form.photo(class="file-input", accept="image/*") }}
            </div>
            {% if form.photo.errors %}
                {% for error in form.photo.errors %}
                    <span class="error">{{ error }}</span>
                {% endfor %}
            {% endif %}
            <small>Supported formats: JPG, PNG, GIF (Max size: 16MB)</small>
        </div>

        <div id="image-preview" style="display: none;">
            <h3>Preview:</h3>
            <img id="preview-img" src="#" alt="Image preview">
        </div>

        {{ form.submit(class="btn-submit") }}
    </form>
</div>

<script>
    document.getElementById('photo').onchange = function(evt) {
        var preview = document.getElementById('preview-img');
        var previewContainer = document.getElementById('image-preview');
        var file = evt.target.files[0];

        if (file) {
            var reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                previewContainer.style.display = 'block';
            }
            reader.readAsDataURL(file);
        } else {
            previewContainer.style.display = 'none';
        }
    };
</script>
{% endblock %}